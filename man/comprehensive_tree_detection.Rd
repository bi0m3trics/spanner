% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/comprehensive_tree_detection.R
\name{comprehensive_tree_detection}
\alias{comprehensive_tree_detection}
\title{Comprehensive Tree Detection with Two-Phase RANSAC Filtering}
\usage{
comprehensive_tree_detection(
  las,
  neigh_sizes = c(0.5, 0.25, 0.75),
  res = 0.05,
  grid_slice_min = 1.2,
  grid_slice_max = 1.8,
  dens_threshold = 0.15,
  vert_threshold = 0.6,
  minimum_area = 0.1,
  pt_spacing = 0.025,
  SDvert = 0.15,
  ransac_error_threshold = 0.15,
  cylinder_search_radius = 0.4,
  min_cylinder_points = 15,
  n_ransac_samples = 10,
  ransac_confidence = 0.95,
  ransac_inliers = 0.8,
  max_angle = 20,
  n_best = 20,
  second_pass_vert_threshold = 0.75,
  second_pass_aniso_threshold = 0.7,
  ncpu = parallel::detectCores(logical = FALSE),
  verbose = TRUE
)
}
\arguments{
\item{las}{LAS object containing the normalized point cloud}

\item{neigh_sizes}{Neighborhood sizes for analysis c(eigen_radius, small_density_radius, large_density_radius)}

\item{res}{Grid resolution for raster operations}

\item{grid_slice_min}{Minimum height for processing slice}

\item{grid_slice_max}{Maximum height for processing slice}

\item{dens_threshold}{Density threshold for initial tree detection}

\item{vert_threshold}{Verticality threshold for initial tree detection}

\item{minimum_area}{Minimum area for tree candidate regions}

\item{pt_spacing}{Point spacing for downsampling}

\item{SDvert}{Standard deviation threshold for verticality filtering}

\item{ransac_error_threshold}{Maximum acceptable RANSAC error for cylinder fitting}

\item{cylinder_search_radius}{Radius for extracting points around tree locations for cylinder fitting}

\item{min_cylinder_points}{Minimum points required for cylinder fitting}

\item{n_ransac_samples}{Number of RANSAC samples for cylinder fitting}

\item{ransac_confidence}{RANSAC confidence level}

\item{ransac_inliers}{RANSAC inlier percentage}

\item{max_angle}{Maximum angle for cylinder fitting (degrees)}

\item{n_best}{Number of best cylinders to consider}

\item{second_pass_vert_threshold}{Higher verticality threshold for second pass}

\item{second_pass_aniso_threshold}{Anisotropy threshold for second pass}

\item{ncpu}{Number of CPU cores to use}

\item{verbose}{Print progress messages}
}
\value{
sf object with tree locations and attributes including TreeID, X, Y, Z, Radius, Error, and Quality
}
\description{
This function provides a complete tree detection workflow using the optimized
get_raster_eigen_treelocs_optimized function with C_geometric_features_simple internally.
It performs initial tree detection, fits cylinders using RANSAC, and then applies a second
pass for trees with poor RANSAC fits, returning an sf object of tree locations.
}
\examples{
\dontrun{
# Load example data
LASfile <- system.file("extdata", "DensePatchA.laz", package="spanner")
las <- readLAS(LASfile, select = "xyzc")

# Detect trees with comprehensive two-phase approach
trees <- comprehensive_tree_detection(
  las = las,
  neigh_sizes = c(0.5, 0.25, 0.75),
  res = 0.05,
  ransac_error_threshold = 0.1,
  verbose = TRUE
)

# Plot results
plot(las, color = "Z", backend = "lidRviewer")
plot(trees$geometry, add = TRUE, col = "red", pch = 16)
}

}
